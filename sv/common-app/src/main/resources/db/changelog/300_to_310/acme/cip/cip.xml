<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
    
    <!--
	<changeSet author="Leap" id="3v1-cip-241029-1">
		<sql>
			Delete from mlschemaregistry WHERE NAME ='ConfigItemRelation' AND ORGANIZATION='leo1311'; 
			Delete from mlschemaregistry WHERE NAME ='ConfigItem' AND ORGANIZATION='leo1311';
		</sql>
	</changeSet>
	<changeSet author="Leap" id="3v1-cip-241029-2">
		<sql>
			Delete from mldataset WHERE alias ='ConfigItemRelationDataset' AND ORGANIZATION='leo1311'; 
			Delete from mlschemaregistry WHERE alias ='ConfigItemDataset' AND ORGANIZATION='leo1311';
		</sql>
	</changeSet>
	<changeSet author="Leap" id="3v1-cip-241029-3">
		<sql>
			Delete from mlrelationship WHERE name ='ParentConfigItem' AND ORGANIZATION='leo1311'; 
			Delete from mlrelationship WHERE name ='ChildConfigItem' AND ORGANIZATION='leo1311'; 
			Delete from mlrelationship WHERE name ='ConfigItemTicket' AND ORGANIZATION='leo1311'; 
		</sql>
	</changeSet>
	 <changeSet author="Leap" id="3v1-cip-240918">
	<sql splitStatements="true" stripComments="true">
		UPDATE mlschemaregistry SET NAME='Application_and_Middleware' WHERE NAME=' Application_and_Middleware' and organization='leo1311';
	</sql>
 </changeSet>

 <changeSet author="Leap" id="3v1-cip-241022-2">
    <sql dbms="mysql" splitStatements="true" stripComments="true"> 
		UPDATE mldataset SET attributes ='{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT COUNT(*) as \\\"SCHEDULED_JOBS\\\" FROM (SELECT job_name FROM bjm_job_instance WHERE project_id=({projectId}) and start_time between ({startDate}) and ({endDate}) AND STATUS=\'scheduled\' GROUP BY job_name) AS temp\",\"Cacheable\":false,\"isStreaming\":\"false\",\"defaultValues\":\"\",\"writeMode\":\"append\",\"params\":\"{\'projectId\':\'project_id\',\'startDate\':\'\\\\\'2018-04-01\\\\\'\' , \'endDate\':\'(SELECT CURRENT_TIMESTAMP)\'}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}' where name = 'Acme_bjm1_scheduled_jobs' and organization ='leo1311';
    </sql> 
  </changeSet>

  <changeSet author="leap" id="3v1-cip-2411115-01">
  <sql>
  Delete from mlschemaregistry WHERE NAME ='Variant' AND ORGANIZATION='leo1311';
  </sql>
	
</changeSet>
  
  <changeSet author="leap" id="3v1-cip-241029-4">
	<loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mlschemaregistry.csv" quotchar="&quot;" separator="," tableName="mlschemaregistry">
		<column header="id" name="id" type="NUMERIC"/>
		<column header="formtemplate" name="formtemplate" type="STRING"/>
		<column header="name" name="name" type="STRING"/>
		<column header="organization" name="organization" type="STRING"/>
		<column header="description" name="description" type="skip"/>
		<column header="schemavalue" name="schemavalue" type="STRING"/>
		<column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
		<column header="alias" name="alias" type="STRING"/>
		<column header="lastmodifieddate" name="lastmodifieddate" type="DATE"/>
		<column header="type" name="type" type="STRING"/>
        <column header="capability" name="capability" type="STRING"/>
	</loadData>
</changeSet>
<changeSet author="leap" id="3v1-cip-241029-5">  
	<loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mlrelationship.csv" quotchar="&quot;" separator="," tableName="mlrelationship">
		<column header="id" name="id" type="NUMERIC"/>
		<column header="name" name="name" type="STRING"/>
		<column header="schemaA" name="schemaA" type="STRING"/>
		<column header="schemaB" name="schemaB" type="STRING"/>
		<column header="schema_relation" name="schema_relation" type="STRING"/>
		<column header="relationship_template" name="relationship_template" type="skip"/>
		<column header="organization" name="organization" type="STRING"/>
		<column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
		<column header="alias" name="alias" type="STRING"/>
		<column header="lastmodifieddate" name="lastmodifieddate" type="DATE"/>
	</loadData>
</changeSet>


<changeSet author="Leap" id="3v1-cip-241029-6-1">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                            SELECT COUNT(*) FROM mldataset WHERE name='HPECNFGT91584' and Organization='leo1311';
            </sqlCheck>
        </preConditions>        
        <sql dbms="h2, mysql" splitStatements="true" stripComments="true">
            insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT t1.cmdb_ci_sys_id , t1.ci_name , t1.sys_class_name ctype , t1.ctype ctype_id, CONCAT(\'L\',t1.order_value) order_value,t1.location location,t1.sys_class_name iconName,t1.cmdb_ci_sys_id  uniqueId,CASE WHEN t1.incident_count > 0 THEN \'disrupted\' WHEN t1.alert_count >0 THEN \'impacted\' ELSE \'available\' END  AS \'status\', incident_count AS incidentsCount,alert_count AS alertCount FROM cfm_configuration_item t1 WHERE  t1.cmdb_ci_sys_id IS NOT NULL and project_id=2;\",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,'ConfigItemDataset','0','HPECNFGT91584','leo1311',NULL,'rw',NULL,'ConfigItem','leapmaster','admin','2023-08-28 12:20:30.324781','ConfigItemDataset',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
        <sql dbms="mssql" splitStatements="true" stripComments="true">
            insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values('{"filter":"","mode":"query","Query":"SELECT DISTINCT t1.cmdb_ci_sys_id , t1.ci_name , t1.sys_class_name ctype , t1.ctype ctype_id, CONCAT(''L'',t1.order_value) order_value,t1.location location,t1.sys_class_name iconName,t1.cmdb_ci_sys_id  uniqueId,CASE WHEN t1.incident_count > 0 THEN ''disrupted'' WHEN t1.alert_count >0 THEN ''impacted'' ELSE ''available'' END  AS ''status'', incident_count AS incidentsCount,alert_count AS alertCount FROM cfm_configuration_item t1 WHERE  t1.cmdb_ci_sys_id IS NOT NULL and project_id=2;","Cacheable":false,"isStreaming":"false","Headers":"","defaultValues":"","QueryParams":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""}',NULL,'ConfigItemDataset','0','HPECNFGT91584','leo1311',NULL,'rw',NULL,'ConfigItem','leapmaster','admin','','ConfigItemDataset',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
</changeSet>


<changeSet author="Leap" id="3v1-cip-241029-6-2">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                            SELECT COUNT(*) FROM mldataset WHERE name='HPECNFGT90007' and Organization='leo1311';
            </sqlCheck>
        </preConditions>        
        <sql dbms="h2, mysql" splitStatements="true" stripComments="true">
            insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT distinct child_sys_id \'ChildId\',relation_type \'RelationName\',parent_sys_id\'ParentId\',CONCAT (child_sys_id,\'-\',parent_sys_id) uniqueId FROM cfm_xw_ci_mapping WHERE parent_sys_id IS NOT NULL  and child_sys_id IS NOT NULL; \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,'ConfigItemRelationDataset','0','HPECNFGT90007','leo1311',NULL,'rw',NULL,'ConfigItemRelation','leapmaster','admin','2023-08-28 12:21:15.378375','ConfigItemRelationDataset',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
        <sql dbms="mssql" splitStatements="true" stripComments="true">
            insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values('{"filter":"","mode":"query","Query":"SELECT distinct child_sys_id ''ChildId'',relation_type ''RelationName'',parent_sys_id ''ParentId'',CONCAT (child_sys_id,''-'',parent_sys_id) uniqueId FROM cfm_xw_ci_mapping WHERE parent_sys_id IS NOT NULL  and child_sys_id IS NOT NULL; ","Cacheable":false,"isStreaming":"false","Headers":"","defaultValues":"","QueryParams":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""}',NULL,'ConfigItemRelationDataset','0','HPECNFGT90007','leo1311',NULL,'rw',NULL,'ConfigItemRelation','leapmaster','admin',NULL,'ConfigItemRelationDataset',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
</changeSet>



<changeSet author="Leap" id="3v1-cip-241029-6-3">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                            SELECT COUNT(*) FROM mldataset WHERE name='AlertAndIncident' and Organization='leo1311';
            </sqlCheck>
        </preConditions>  
             
        <sql dbms="h2, mysql" splitStatements="true" stripComments="true">
             insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT  cmdb_ci_sys_id AS uniqueId, cmdb_ci_sys_id AS sysId,priority,type,number,SHORTDESCRIPTION Description ,state,location,  openedDate FROM leapmaster_ref_data.leo1311_tickets WHERE cmdb_ci_sys_id!=\'\' AND state IN (\'Open\',\'On Hold\',\'New\',\'In Progress\',\'Re-Warn\',\'Re-Triggered\',\'Triggered\',\'Warn\'); ; \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,'AlertAndIncidentDataset','0','AlertAndIncident','leo1311',NULL,'rw',NULL,'AlertAndIncident','leo1311','admin','2023-08-28 12:21:15.378375','AlertAndIncidentDataset',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
        
        <sql dbms="mssql" splitStatements="true" stripComments="true">
             insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values('{"filter":"","mode":"query","Query":"SELECT  cmdb_ci_sys_id AS uniqueId, cmdb_ci_sys_id AS sysId,priority,type,number,SHORTDESCRIPTION Description ,state,location,  openedDate FROM @projectname_tickets WHERE cmdb_ci_sys_id!='''' AND state IN (''Open'',''On Hold'',''New'',''In Progress'',''Re-Warn'',''Re-Triggered'',''Triggered'',''Warn''); ","Cacheable":false,"isStreaming":"false","Headers":"","defaultValues":"","QueryParams":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""}',NULL,'AlertAndIncidentDataset','0','AlertAndIncident','leo1311',NULL,'rw',NULL,'AlertAndIncident','leo1311','admin',NULL,'AlertAndIncidentDataset',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);

</sql>

</changeSet>



<changeSet author="Leap" id="3v1-cip-241029-6-4">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                            SELECT COUNT(*) FROM mldataset WHERE name='Destinationwarehousemapping' and Organization='leo1311';
            </sqlCheck>
        </preConditions>        
        <sql dbms="h2, mysql" splitStatements="true" stripComments="true">
             insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT CONCAT(WH_Address,ArrivalPort, OrderNumber) AS uniqueId, WH_Address,ArrivalPort,DestinationCountry,OrderNumber FROM shipment_data_v5 GROUP BY uniqueId; \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,'Destinationwarehousemapping','0','Destinationwarehousemapping','leo1311',NULL,'rw',NULL,'Destinationwarehousemapping','leo1311','admin','2023-08-28 12:21:15.378375','Destinationwarehousemapping',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
        <sql dbms="mssql" splitStatements="true" stripComments="true">
             insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT CONCAT(WH_Address,ArrivalPort, OrderNumber) AS uniqueId, WH_Address,ArrivalPort,DestinationCountry,OrderNumber FROM shipment_data_v5 GROUP BY uniqueId; \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,'Destinationwarehousemapping','0','Destinationwarehousemapping','leo1311',NULL,'rw',NULL,'Destinationwarehousemapping','leo1311','admin',NULL,'Destinationwarehousemapping',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
</changeSet>



<changeSet author="Leap" id="3v1-cip-241029-6-5">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                            SELECT COUNT(*) FROM mldataset WHERE name='Origincarriermapping' and Organization='leo1311';
            </sqlCheck>
        </preConditions>        
        <sql dbms="h2, mysql" splitStatements="true" stripComments="true">
                         insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values(' {\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT CONCAT(OriginPort,CarrierName,OrderNumber) AS uniqueId, OriginPort, CarrierName,OrderNumber FROM shipment_data_v5; \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,'Origincarriermapping','0','Origincarriermapping','leo1311',NULL,'rw',NULL,'Origincarriermapping','leo1311','admin','2023-08-28 12:21:15.378375','Origincarriermapping',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
        <sql dbms="mssql" splitStatements="true" stripComments="true">
                         insert into mldataset ( attributes, dataset_type, description, exp_status, name, organization, schemajson, type, backing_dataset, dataset_schema, datasource, lastmodifiedby, lastmodifieddate, alias, context, is_approval_required, is_permission_managed, is_inbox_required, is_audit_required, is_archival_enabled, archival_config, dashboard, metadata, modeltype, views, taskdetails, tags, interfacetype, adaptername, isadapteractive, indexname, summary, event_details) values(' {\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT DISTINCT CONCAT(OriginPort,CarrierName,OrderNumber) AS uniqueId, OriginPort, CarrierName,OrderNumber FROM shipment_data_v5; \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,'Origincarriermapping','0','Origincarriermapping','leo1311',NULL,'rw',NULL,'Origincarriermapping','leo1311','admin',NULL,'Origincarriermapping',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
        </sql>
</changeSet>

  
  <changeSet author="Leap" id="3v1-cip-20241023-1">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                            SELECT COUNT(*) FROM mldataset WHERE name='TicketsData' and Organization='leo1311';
            </sqlCheck>
        </preConditions>
        
		<sql dbms="h2, mysql" splitStatements="true" stripComments="true">
		INSERT INTO mldataset (attributes,NAME,ORGANIZATION,alias,datasource) VALUES('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t1.number,t1.cmdb_ci_sys_id,t1.configurationItem as ci_name,t1.shortdescription,t1.createdDate,t1.priority,t1.type,t1.sysId  FROM  leo1311_tickets t1 join leapmaster.cfm_configuration_item ci on t1.cmdb_ci_sys_id=ci.cmdb_ci_sys_id WHERE t1.state IN (\'\Open\'\,\'\On Hold\'\,\'\New\'\,\'\In Progress\'\,\'\Re-Warn\'\,\'\Re-Triggered\'\,\'\Triggered\'\,\'\Warn\'\) and ci.cmdb_ci_sys_id in ({cmdb_ci_sys_id})  and ci.project_id= {project_id} and ci.location IN ({location}) and t1.type IN ({ticketstype}) and (ci.alert_count>0 OR ci.incident_count >0 OR ci.log_count >0) AND t1.severity in ({severity}) AND ci.sys_class_name = ({sys_class_name}) and ({searchKey} IS NULL OR (configurationItem LIKE {searchKey} OR NUMBER LIKE {searchKey})) union all SELECT t1.id AS NUMBER,t1.cmdb_ci_sys_id ,t1.ci_name,t1.logs AS shortdescription, t1.createdDate,t1.priority,t1.type,NULL AS sysId FROM leo1311_tickets_logs t1 WHERE t1.type IN ({ticketstype}) AND t1.ci_type IN ({ci_type}) AND ({searchKey} IS NULL OR (ci_name LIKE {searchKey} OR id LIKE {searchKey})) AND t1.cmdb_ci_sys_id IN ({cmdb_ci_sys_id_log}) \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{\'\cmdb_ci_sys_id\'\:\'\ci.cmdb_ci_sys_id\'\,\'ticketstype\'\:\'t1.type\'\,\'\location\'\:\'\ci.location\'\,\'\project_id\'\:\'\2\'\,\'\ci_type\'\:\'t1.ci_type\'\,\'\cmdb_ci_sys_id_log\'\:\'t1.cmdb_ci_sys_id\'\,\'\severity\'\:\'t1.severity\'\,\'\sys_class_name\'\:\'\ci.sys_class_name\'\,\'\searchKey\'\:\'\NULL\'\}\",\"tableName\":\"\",\"uniqueIdentifier\":\"priority,createdDate\"}','TicketsData','leo1311','TicketsData','leo1311');
        </sql>	
        
	</changeSet>
    <changeSet author="Leap" id="3v1-cip-20241023-1-2">
        <validCheckSum>any</validCheckSum>
		<preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                            SELECT COUNT(*) FROM mldataset WHERE name='TicketsData' and Organization='leo1311';
            </sqlCheck>
        </preConditions>
		<sql dbms="mssql" splitStatements="true" stripComments="true">
		INSERT INTO mldataset (attributes,NAME,ORGANIZATION,alias,datasource) VALUES('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t1.number,t1.cmdb_ci_sys_id,t1.configurationItem as ci_name,t1.shortdescription,t1.createdDate,t1.priority,t1.type,t1.sysId  FROM leo1311_tickets t1 join [leapmaster].[dbo].[cfm_configuration_item] ci on t1.cmdb_ci_sys_id=ci.cmdb_ci_sys_id  WHERE t1.[state] IN (''Open'',''On Hold'',''New'',''In Progress'',''Re-Warn'',''Re-Triggered'',''Triggered'',''Warn'') and ci.cmdb_ci_sys_id in ({cmdb_ci_sys_id}) and ({searchKey} IS NULL OR (configurationItem LIKE {searchKey} OR NUMBER LIKE {searchKey})) and ci.project_id= {project_id} and ci.location IN ({location}) and t1.type IN ({ticketstype}) and (ci.alert_count>0 OR ci.incident_count >0 OR ci.log_count >0) AND t1.severity in ({severity}) AND ci.sys_class_name = ({sys_class_name}) union all SELECT t1.id AS NUMBER,t1.cmdb_ci_sys_id ,t1.ci_name,t1.logs AS shortdescription, t1.createdDate,t1.priority, t1.type,NULL AS sysId FROM leo1311_tickets_logs t1 WHERE t1.type IN ({ticketstype}) AND t1.ci_type IN ({ci_type}) AND t1.cmdb_ci_sys_id IN ({cmdb_ci_sys_id_log}) and ({searchKey} IS NULL OR (ci_name LIKE {searchKey} OR id LIKE {searchKey})) \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{''cmdb_ci_sys_id'':''ci.cmdb_ci_sys_id'',''ticketstype'':''t1.type'',''location'':''ci.location'',''project_id'':''2'',''ci_type'':''t1.ci_type'',''cmdb_ci_sys_id_log'':''t1.cmdb_ci_sys_id'',''severity'':''t1.severity'',''sys_class_name'':''ci.sys_class_name'',''searchKey'':''NULL''}\",\"tableName\":\"\",\"uniqueIdentifier\":\"priority,createdDate\"}','TicketsData','leo1311','TicketsData','leo1311');
        </sql>  
	</changeSet>
     
    <changeSet author="Leap" id="3v1-cip-20241023-2">
        <preConditions onFail="MARK_RAN">
             <sqlCheck expectedResult="0">
                            SELECT COUNT(*) FROM mldataset WHERE name='TicketsTypes' and Organization='leo1311';
            </sqlCheck>
        </preConditions>
		<sql dbms="h2, mysql" splitStatements="true" stripComments="true">
		INSERT INTO mldataset (attributes,NAME,ORGANIZATION,alias,datasource) VALUES('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT type FROM @projectname_tickets WHERE state IN(\'\open\'\,\'\In Progress\'\) AND type IN (\'\Incidents\'\,\'\Alerts\'\,\'\Incident\'\,\'\MI\'\) GROUP BY type UNION SELECT type FROM @projectname_tickets_logs GROUP BY type \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}','TicketsTypes','leo1311','TicketsTypes','leo1311');
        </sql> 
		<sql dbms="mssql" splitStatements="true" stripComments="true">
		INSERT INTO mldataset (attributes,NAME,ORGANIZATION,alias,datasource) VALUES('{"filter":"","mode":"query","Query":"SELECT type FROM @projectname_tickets WHERE state IN(''open'',''In Progress'') AND type IN (''Incidents'',''Alerts'',''Incident'',''MI'') GROUP BY type UNION SELECT type FROM @projectname_tickets_logs GROUP BY type ","Cacheable":false,"isStreaming":"false","Headers":"","defaultValues":"","QueryParams":"","writeMode":"append","params":"{}","tableName":"","uniqueIdentifier":""}','TicketsTypes','leo1311','TicketsTypes','leo1311');
        </sql> 
	</changeSet>

    <changeSet author="Leap" id="3v1-cip-20241023-3">
		<sql dbms="h2, mysql" splitStatements="true" stripComments="true">  
		INSERT INTO mldataset (attributes,NAME,ORGANIZATION,alias,datasource) VALUES('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t1.number,t1.cmdb_ci_sys_id,t1.configurationItem as ci_name,t1.shortdescription,t1.createdDate,t1.priority,t1.type,t1.sysId  FROM  leo1311_tickets t1 join leapmaster.cfm_configuration_item ci on t1.cmdb_ci_sys_id=ci.cmdb_ci_sys_id WHERE t1.state IN (\'\Open\'\,\'\On Hold\'\,\'\New\'\,\'\In Progress\'\,\'\Re-Warn\'\,\'\Re-Triggered\'\,\'\Triggered\'\,\'\Warn\'\,\'\Closed\'\) and ci.cmdb_ci_sys_id in ({cmdb_ci_sys_id})  and ci.project_id= {project_id} and ci.location IN ({location}) and t1.type IN ({ticketstype}) AND t1.severity in ({severity}) AND ci.sys_class_name = ({sys_class_name}) and ({searchKey} IS NULL OR (configurationItem LIKE {searchKey} OR NUMBER LIKE {searchKey})) union all SELECT t1.id AS NUMBER,t1.cmdb_ci_sys_id ,t1.ci_name,t1.logs AS shortdescription, t1.createdDate,t1.priority,t1.type,NULL AS sysId FROM leo1311_tickets_logs t1 WHERE t1.type IN ({ticketstype}) AND t1.ci_type IN ({ci_type}) AND ({searchKey} IS NULL OR (ci_name LIKE {searchKey} OR id LIKE {searchKey})) AND t1.cmdb_ci_sys_id IN ({cmdb_ci_sys_id_log}) \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{\'\cmdb_ci_sys_id\'\:\'\ci.cmdb_ci_sys_id\'\,\'ticketstype\'\:\'t1.type\'\,\'\location\'\:\'\ci.location\'\,\'\project_id\'\:\'\2\'\,\'\ci_type\'\:\'t1.ci_type\'\,\'\cmdb_ci_sys_id_log\'\:\'t1.cmdb_ci_sys_id\'\,\'\severity\'\:\'t1.severity\'\,\'\sys_class_name\'\:\'\ci.sys_class_name\'\,\'\searchKey\'\:\'\NULL\'\}\",\"tableName\":\"\",\"uniqueIdentifier\":\"priority,createdDate\"}','TicketsDataAllCis','leo1311','TicketsDataAllCis','leo1311');
        </sql> 
		<sql dbms="mssql" splitStatements="true" stripComments="true">
		INSERT INTO mldataset (attributes,NAME,ORGANIZATION,alias,datasource) VALUES('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT t1.number,t1.cmdb_ci_sys_id,t1.configurationItem as ci_name,t1.shortdescription,t1.createdDate,t1.priority,t1.type,t1.sysId  FROM  leo1311_tickets t1 join [leapmaster].[dbo].[cfm_configuration_item] ci on t1.cmdb_ci_sys_id=ci.cmdb_ci_sys_id  WHERE t1.[state] IN (''Open'',''On Hold'',''New'',''In Progress'',''Re-Warn'',''Re-Triggered'',''Triggered'',''Warn'',''Closed'') and ci.cmdb_ci_sys_id in ({cmdb_ci_sys_id}) and ({searchKey} IS NULL OR (configurationItem LIKE {searchKey} OR NUMBER LIKE {searchKey})) and ci.project_id= {project_id} and ci.location IN ({location}) and t1.type IN ({ticketstype}) AND t1.severity in ({severity}) AND ci.sys_class_name = ({sys_class_name}) union all SELECT t1.id AS NUMBER,t1.cmdb_ci_sys_id ,t1.ci_name,t1.logs AS shortdescription, t1.createdDate,t1.priority, t1.type,NULL AS sysId FROM leo1311_tickets_logs t1 WHERE t1.type IN ({ticketstype}) AND t1.ci_type IN ({ci_type}) AND t1.cmdb_ci_sys_id IN ({cmdb_ci_sys_id_log}) and ({searchKey} IS NULL OR (ci_name LIKE {searchKey} OR id LIKE {searchKey})) \",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{''cmdb_ci_sys_id'':''ci.cmdb_ci_sys_id'',''ticketstype'':''t1.type'',''location'':''ci.location'',''project_id'':''2'',''ci_type'':''t1.ci_type'',''cmdb_ci_sys_id_log'':''t1.cmdb_ci_sys_id'',''severity'':''t1.severity'',''sys_class_name'':''ci.sys_class_name'',''searchKey'':''NULL''}\",\"tableName\":\"\",\"uniqueIdentifier\":\"priority,createdDate\"}','TicketsDataAllCis','leo1311','TicketsDataAllCis','leo1311');
        </sql> 
	</changeSet>
	

	<changeSet author="Leap" id="3v0-sre-102520245-1">
                <sql dbms="mysql" splitStatements="true" stripComments="true"> 
update mldataset set attributes ='{"filter":"","mode":"query","Query":"SELECT sre_app_availability.application_name  AS  ''APPLICATION NAME'',  sre_app_availability.application_grp_name AS ''APPLICATION GROUP NAME'',  sre_app_availability.probe_name AS ''PROBE NAME'' , sre_app_availability.location_name AS ''LOCATION NAME'',   sre_app_availability.perc_availability AS ''PERCENTAGE AVAILABILITY'' FROM sre_app_availability   INNER JOIN ccl_app ON  ccl_app.application_id=sre_app_availability.application_id  WHERE ccl_app.project_id=({projectId}) AND   sre_app_availability.application_name IN ({application_name})","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''projectId'':''ccl_app.project_id'',''application_name'':''sre_app_availability.application_name''}","tableName":"","uniqueIdentifier":""}' where alias = 'allapplicationsperc' and organization = 'leo1311';

                </sql> 
                <sql dbms="mysql" splitStatements="true" stripComments="true">
update mldataset set attributes ='{"filter":"","mode":"query","Query":"SELECT application_grp_name AS ''Application Group Name'',location_name AS ''Location Name'',run_start_time AS ''Run Start Time'',run_end_time AS ''Run End Time'',run_time AS ''Run Time''
FROM sre_probe_run_app
INNER JOIN ccl_app ON sre_probe_run_app.application_id = ccl_app.application_id
INNER JOIN ccl_app_grp ON ccl_app.application_grp_id = ccl_app_grp.application_grp_id
INNER JOIN sre_location ON sre_probe_run_app.location_id = sre_location.location_id
WHERE run_result = 1
AND ccl_app.project_id = ccl_app.project_id
GROUP BY application_grp_name, location_name, run_start_time, run_end_time, run_time","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"" ,"tableName":"","uniqueIdentifier":""}' where alias = 'testapplicationgroupwithactiveprobe' and organization = 'leo1311';
                </sql>
                <sql dbms="mysql" splitStatements="true" stripComments="true">
update mldataset set attributes ='{"filter":"","mode":"query","Query":"SELECT application_name AS ''Application Name'',
       run_start_time AS ''Start Time'',
       run_end_time AS ''End Time''
FROM (
    SELECT ccl_app.application_name,
           sre_probe_run_app.run_start_time,
           sre_probe_run_app.run_end_time,
           ROW_NUMBER() OVER (PARTITION BY ccl_app.application_name ORDER BY sre_probe_run_app.run_start_time DESC) AS rn
    FROM ccl_app
    INNER JOIN sre_probe_run_app ON sre_probe_run_app.application_id = ccl_app.application_id
    WHERE project_id = {projectId} AND run_result = 0
) AS ranked
WHERE rn =1","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"" ,"tableName":"","uniqueIdentifier":""}' where alias = 'Failed_Applications_Name' and organization = 'leo1311';
              </sql>
              <sql dbms="mysql" splitStatements="true" stripComments="true">

update mldataset set attributes = '{"filter":"","mode":"query","Query":"SELECT SUM(counts) AS total_count
FROM (
    SELECT COUNT(*) AS counts
    FROM sre_location
    INNER JOIN sre_probe_run_app ON sre_probe_run_app.location_id = sre_location.location_id
    INNER JOIN ccl_app ON sre_probe_run_app.application_id = ccl_app.application_id
    INNER JOIN ccl_app_grp ON ccl_app_grp.application_grp_id = ccl_app.application_grp_id
    WHERE location_name IN (location_name) 
      AND application_name IN (application_name)
      AND run_date BETWEEN "2019-09-01" AND "2023-12-30"
      AND run_result IN ("0", "1") 
      AND application_grp_name IN (application_grp_name)
    GROUP BY probe_run_app_id, run_description, SUT, run_start_time, run_end_time, run_result
) AS grouped_counts","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"" ,"tableName":"","uniqueIdentifier":""}' where alias = 'ApplicationDetails' and organization = 'leo1311';
              </sql>


       </changeSet>

<changeSet author="Leap" id="3v1-cip-241105-1">
        <sql>
            Delete from mlschemaregistry WHERE NAME ='OrderWarehouseMapping' AND ORGANIZATION='leo1311';
            Delete from mlschemaregistry WHERE NAME ='Ordercarriermapping' AND ORGANIZATION='leo1311';
            Delete from mlschemaregistry WHERE NAME ='Ordercontainermapping' AND ORGANIZATION='leo1311';
            Delete from mldataset WHERE alias ='OrderWarehouseMapping' AND ORGANIZATION='leo1311';
            Delete from mldataset WHERE alias ='Ordercarriermapping' AND ORGANIZATION='leo1311';
            Delete from mldataset WHERE alias ='Ordercontainermapping' AND ORGANIZATION='leo1311';
            Delete from mlrelationship WHERE name ='MappingOrderWarehouse' AND ORGANIZATION='leo1311';
            Delete from mlrelationship WHERE name ='OrderWarehouseMapping' AND ORGANIZATION='leo1311';  
            Delete from mlrelationship WHERE name ='Mappingordercarrier' AND ORGANIZATION='leo1311';
            Delete from mlrelationship WHERE name ='Ordercarriermapping' AND ORGANIZATION='leo1311';
            Delete from mlrelationship WHERE name ='Mappingordercontainer' AND ORGANIZATION='leo1311';
            Delete from mlrelationship WHERE name ='Ordercontainermapping' AND ORGANIZATION='leo1311';
        </sql>
    </changeSet>


	<changeSet author="Leap" id="3v0-sre-110700245-1">

<sql dbms="mysql" splitStatements="true" stripComments="true">
insert into `mldataset` ( `attributes`, `dataset_type`, `description`, `exp_status`, `name`, `organization`, `schemajson`, `type`, `backing_dataset`, `dataset_schema`, `datasource`, `lastmodifiedby`, `lastmodifieddate`, `alias`, `context`, `is_approval_required`, `is_permission_managed`, `is_inbox_required`, `is_audit_required`, `is_archival_enabled`, `archival_config`, `dashboard`, `metadata`, `modeltype`, `views`, `taskdetails`, `tags`, `interfacetype`, `adaptername`, `isadapteractive`, `indexname`, `summary`, `event_details`) values('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT application_grp_name AS \'Application Group Name\',location_name AS \'Location Name\',run_start_time AS \'Run Start Time\',run_end_time AS \'Run End Time\',run_time AS \'Run Time\'\\nFROM sre_probe_run_app\\nINNER JOIN ccl_app ON sre_probe_run_app.application_id = ccl_app.application_id\\nINNER JOIN ccl_app_grp ON ccl_app.application_grp_id = ccl_app_grp.application_grp_id\\nINNER JOIN sre_location ON sre_probe_run_app.location_id = sre_location.location_id\\nWHERE run_result = 1\\nAND ccl_app.project_id = ccl_app.project_id\\nGROUP BY application_grp_name, location_name, run_start_time, run_end_time, run_time\",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,NULL,NULL,'LEOGRPWT33084','leo1311',NULL,'r',NULL,NULL,'leapmaster','nirmal.sebastian@infosys.com','2024-11-07 05:31:04.822929','groupwithactiveprobe',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,'Table View',NULL,'[]',NULL,NULL,NULL,NULL,NULL,NULL);

</sql>



<sql dbms="mysql" splitStatements="true" stripComments="true">
insert into `mldataset` ( `attributes`, `dataset_type`, `description`, `exp_status`, `name`, `organization`, `schemajson`, `type`, `backing_dataset`, `dataset_schema`, `datasource`, `lastmodifiedby`, `lastmodifieddate`, `alias`, `context`, `is_approval_required`, `is_permission_managed`, `is_inbox_required`, `is_audit_required`, `is_archival_enabled`, `archival_config`, `dashboard`, `metadata`, `modeltype`, `views`, `taskdetails`, `tags`, `interfacetype`, `adaptername`, `isadapteractive`, `indexname`, `summary`, `event_details`) values('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT application_name AS \'Application Name\',\\n       run_start_time AS \'Start Time\',\\n       run_end_time AS \'End Time\'\\nFROM (\\n    SELECT ccl_app.application_name,\\n           sre_probe_run_app.run_start_time,\\n           sre_probe_run_app.run_end_time,\\n           ROW_NUMBER() OVER (PARTITION BY ccl_app.application_name ORDER BY sre_probe_run_app.run_start_time DESC) AS rn\\n    FROM ccl_app\\n    INNER JOIN sre_probe_run_app ON sre_probe_run_app.application_id = ccl_app.application_id\\n    WHERE project_id = 2 AND run_result = 0\\n) AS ranked\\nWHERE rn =1\",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,NULL,NULL,'LEOFLD_P91666','leo1311',NULL,'r',NULL,NULL,'leapmaster','nirmal.sebastian@infosys.com','2024-11-07 05:45:20.398849','failed_appname',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,'Table View','[]','[]',NULL,NULL,NULL,NULL,NULL,NULL);
</sql>




<sql dbms="mysql" splitStatements="true" stripComments="true">
insert into `mldataset` ( `attributes`, `dataset_type`, `description`, `exp_status`, `name`, `organization`, `schemajson`, `type`, `backing_dataset`, `dataset_schema`, `datasource`, `lastmodifiedby`, `lastmodifieddate`, `alias`, `context`, `is_approval_required`, `is_permission_managed`, `is_inbox_required`, `is_audit_required`, `is_archival_enabled`, `archival_config`, `dashboard`, `metadata`, `modeltype`, `views`, `taskdetails`, `tags`, `interfacetype`, `adaptername`, `isadapteractive`, `indexname`, `summary`, `event_details`) values('{\"filter\":\"\",\"mode\":\"query\",\"Query\":\"SELECT SUM(counts) AS total_count\\nFROM (\\n    SELECT COUNT(*) AS \\\"counts\\\"\\n    FROM sre_location\\n    INNER JOIN sre_probe_run_app ON sre_probe_run_app.location_id = sre_location.location_id\\n    INNER JOIN ccl_app ON sre_probe_run_app.application_id = ccl_app.application_id\\n    INNER JOIN ccl_app_grp ON ccl_app_grp.application_grp_id = ccl_app.application_grp_id\\n    WHERE location_name IN (location_name) \\n      AND application_name IN (application_name)\\n      AND run_date BETWEEN \\\"2019-09-01\\\" AND \\\"2023-12-30\\\"\\n      AND run_result IN (\\\"0\\\", \\\"1\\\") \\n      AND application_grp_name IN (application_grp_name)\\n    GROUP BY probe_run_app_id, run_description, SUT, run_start_time, run_end_time, run_result\\n) AS grouped_counts\",\"Cacheable\":false,\"isStreaming\":\"false\",\"Headers\":\"\",\"defaultValues\":\"\",\"QueryParams\":\"\",\"writeMode\":\"append\",\"params\":\"{}\",\"tableName\":\"\",\"uniqueIdentifier\":\"\"}',NULL,NULL,NULL,'LEOAP_DT48363','leo1311',NULL,'r',NULL,NULL,'leapmaster','nirmal.sebastian@infosys.com','2024-11-07 05:53:07.900863','app_details',NULL,'','','','',NULL,NULL,NULL,NULL,NULL,'Table View','[]','[]',NULL,NULL,NULL,NULL,NULL,NULL);

</sql>



<sql dbms="mysql" splitStatements="true" stripComments="true">

update dbs_sequence_widget set dataset_name = 'LEOGRPWT33084' where widget_id = 412;
update dbs_sequence_widget set dataset_name = 'LEOFLD_P91666' where widget_id = 411;
update dbs_sequence_widget set dataset_name = 'LEOAP_DT48363' where widget_id = 423;


</sql>

<sql dbms="mysql" splitStatements="true" stripComments="true">

update dbs_widget_configuration set y_axis_alias = 'Failed Probe Runs Count' where id=402 and project_id = 2;
update dbs_widget_configuration set count_column = 'total_count' where id=423 and project_id = 2;

</sql>

</changeSet>

<changeSet author="Leap" id="3v1-cip-241114-1">
    <sql dbms="mysql,mssql" splitStatements="true" stripComments="true"> 
		UPDATE mldataset SET attributes ='{"filter":"","mode":"query","Query":"Select group_by_field as ConfigurationItem, post_ranking_cluster as ClusterName from @projectname_tickets_enriched where post_ranking_cluster in ({cluster}) group by post_ranking_cluster  ,ConfigurationItem","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":" {''cluster'':''post_ranking_cluster''}","tableName":"","uniqueIdentifier":""}' where name = 'Cluster_Details' and organization ='leo1311';
    </sql> 
	<sql dbms="mssql">
		UPDATE mldataset SET attributes ='{"filter":"","mode":"query","Query":"SELECT   number ,  ConfigurationItem,  Category , [State],  Priority,   createdDate AS CreatedDate, ShortDescription FROM @projectname_tickets where ISNULL(ConfigurationItem,'''') = ISNULL({configurationItem},'''') and ISNULL(category,'''') =ISNULL({category},'''') and ISNULL(state,'''') =ISNULL({state},'''') and ISNULL(priority,'''')=ISNULL({priority},'''')","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''configurationItem'':''configurationItem'',''category'':''category'',''state'':''state'',''priority'':''priority''}","tableName":"","uniqueIdentifier":""}' where name = 'TicketDetails' and organization ='leo1311';
	</sql>
	<sql dbms="mysql">
		UPDATE mldataset SET attributes ='{"filter":"","mode":"query","Query":"SELECT   number ,  ConfigurationItem,  Category , `State`,  Priority,   createdDate AS CreatedDate, ShortDescription FROM @projectname_tickets where IFNULL(ConfigurationItem,'''') = IFNULL({configurationItem},'''') and IFNULL(category,'''') =IFNULL({category},'''') and IFNULL(state,'''') =IFNULL({state},'''') and IFNULL(priority,'''')=IFNULL({priority},'''')","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"{''configurationItem'':''configurationItem'',''category'':''category'',''state'':''state'',''priority'':''priority''}","tableName":"","uniqueIdentifier":""}' where name = 'TicketDetails' and organization ='leo1311';
	</sql>
</changeSet>


	<changeSet author="Leap" id="3v1-sre-241115-076">
    <sql dbms="mssql" splitStatements="true" stripComments="true">

update mldataset set attributes = '{"filter":"","mode":"query","Query":"SELECT application_name AS ''APPLICATION_NAME'' ,run_description AS ''PROBE NAME'' , run_date AS ''RUN DATE'' ,   LEFT(run_start_time,8) AS ''START TIME'' ,LEFT(run_end_time,8) AS ''END TIME'' FROM  sre_probe_run_app INNER JOIN ccl_app ON sre_probe_run_app.application_id= ccl_app.application_id WHERE project_id=project_id AND application_name IN (application_name) AND run_result=1;","Cacheable":"false","isStreaming":"false","defaultValues":"","writeMode":"append","params":"" ,"tableName":"","uniqueIdentifier":""}' where alias = 'Testsuccessproberuns' and organization = 'leo1311';
update mldataset set attributes = '{"filter":"","mode":"query","Query":"SELECT ccl_app.application_name AS ''APPLICATION_NAME'' ,sre_probe_run_app.run_description AS ''PROBE NAME'' , sre_probe_run_app.run_date AS ''RUN DATE'' , convert(varchar,sre_probe_run_app.run_start_time,8) AS ''START TIME'' , convert(varchar,sre_probe_run_app.run_end_time,8) AS ''END TIME'' FROM  sre_probe_run_app INNER JOIN ccl_app ON ccl_app.application_id=sre_probe_run_app.application_id WHERE ccl_app.project_id=ccl_app.project_id AND  ccl_app.application_name IN (ccl_app.application_name)  AND sre_probe_run_app.run_result=0","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"","tableName":"","uniqueIdentifier":""}' where alias = 'testfailedproberuns' and organization = 'leo1311';
update mldataset set attributes ='{"filter":"","mode":"query","Query":"SELECT sre_app_availability.application_name  AS  ''APPLICATION_NAME'',  sre_app_availability.application_grp_name AS ''APPLICATION GROUP NAME'',  sre_app_availability.probe_name AS ''PROBE NAME'' , sre_app_availability.location_name AS ''LOCATION NAME'',   sre_app_availability.perc_availability AS ''PERCENTAGE AVAILABILITY'' FROM sre_app_availability   INNER JOIN ccl_app ON  ccl_app.application_id=sre_app_availability.application_id  WHERE ccl_app.project_id=ccl_app.project_id AND   sre_app_availability.application_name IN (sre_app_availability.application_name)","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"","tableName":"","uniqueIdentifier":""}'  where alias = 'AllApplicationsPerc' and organization = 'leo1311';
update mldataset set attributes = '{"filter":"","mode":"query","Query":"SELECT probe_name AS ''Probe_Name'' ,LEFT(run_start_time,8) AS ''Run Start Time'',LEFT(run_end_time,8) AS ''Run End Time'' , run_time AS ''Run Time'', location_name AS ''Location'' FROM sre_probe  INNER JOIN sre_probe_run_app ON sre_probe.probe_id =sre_probe_run_app.probe_id INNER JOIN  sre_location ON sre_probe_run_app.location_id = sre_location.location_id INNER JOIN ccl_app ON sre_probe_run_app.application_id=ccl_app.application_id WHERE run_result=0  AND ccl_app.project_id=ccl_app.project_id","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"","tableName":"","uniqueIdentifier":""}' where alias = 'testfailedprobename' and organization = 'leo1311';
update mldataset set attributes = '{"filter":"","mode":"query","Query":"SELECT application_grp_name AS ''Application_Group_Name'', location_name AS ''Location Name'', convert(varchar,run_start_time,8) AS ''Run Start Time'', convert(varchar,run_end_time,8) AS ''Run End Time'' ,  run_time AS ''Run Time''  FROM sre_probe_run_app  INNER JOIN ccl_app ON sre_probe_run_app.application_id=ccl_app.application_id INNER JOIN  ccl_app_grp ON ccl_app.application_grp_id=ccl_app_grp.application_grp_id INNER JOIN sre_location ON  sre_probe_run_app.location_id = sre_location.location_id WHERE run_result=1  AND ccl_app.project_id=ccl_app.project_id  GROUP BY application_grp_name,location_name,run_start_time,run_end_time,run_time","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"","tableName":"","uniqueIdentifier":""}' where alias = 'testapplicationgroupwithactiveprobe' and organization = 'leo1311';
update mldataset set attributes = '{"filter":"","mode":"query","Query":"SELECT DISTINCT(application_name) AS ''ApplicationName'' , convert(varchar,MAX(sre_probe_run_app.run_start_time),8) AS ''StartTime'' , convert(varchar,sre_probe_run_app.run_end_time,8) AS ''EndTime'' FROM ccl_app INNER JOIN  sre_probe_run_app ON sre_probe_run_app.application_id =ccl_app.application_id AND project_id=project_id AND run_result=0 GROUP BY ccl_app.application_name,sre_probe_run_app.run_start_time,sre_probe_run_app.run_end_time","Cacheable":false,"isStreaming":"false","defaultValues":"","writeMode":"append","params":"","tableName":"","uniqueIdentifier":""}' where alias = 'Failed_Applications_Name' and organization = 'leo1311'; 

</sql>

</changeSet>

<changeSet author="Leap" id="3v0to3v1-cip-241203-1">
	<sql dbms="mysql,mssql,postgresql" splitStatements="true" stripComments="true">
		INSERT INTO aip_activity ( activity_id, activity_name) VALUES('link-endpoint','Link Endpoint');
		INSERT INTO aip_activity ( activity_id, activity_name) VALUES('link-pipeline','Link Pipeline');
		INSERT INTO aip_activity ( activity_id, activity_name) VALUES('link-dataset','Link Dataset');
		INSERT INTO aip_activity ( activity_id, activity_name) VALUES('link-connection','Link Connection');
		INSERT INTO aip_activity ( activity_id, activity_name) VALUES('link-featureStore','Link Feature Store');
		INSERT INTO aip_activity ( activity_id, activity_name) VALUES('link-app','Link App');
		INSERT INTO aip_activity ( activity_id, activity_name) VALUES('link-attachment','Link Attachment');
	</sql>
</changeSet>

<changeSet author="Leap" id="3v0to3v1-cip-241203-2">
	<sql dbms="mysql,mssql,postgresql" splitStatements="true" stripComments="true">
		UPDATE aip_activity SET activity_id = 'link-model' WHERE activity_id = 'link_model';
     </sql>
</changeSet>
<changeSet author="Leap" id="3v1-usm-1">
		<sql dbms="mysql,mssql,postgresql" splitStatements="true" stripComments="false">
		   INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('icip.aip.pluginView','leo1311','all',(SELECT id FROM usm_project WHERE NAME='leo1311'));
		   INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('icip.document.kb.default','leo1311','documents',(SELECT id FROM usm_project WHERE NAME='leo1311'));
		   INSERT INTO usm_constant(item,project_name,item_value,project_id) VALUES ('icip.document.default','leo1311','{"type":"rw","views":"Doc View","bucket":"comprehend-library","path":"document-generate"}',(SELECT id FROM usm_project WHERE NAME='leo1311'));		
        </sql>
</changeSet>

<changeSet  author="Leap"  id="3v00To3v10-cip-002-2">
	<sql splitStatements="true" stripComments="true">
             DELETE FROM mleventjobmapping WHERE eventname='generateScript_LangChain' AND organization='leo1311';
             
             DELETE FROM mlpipeline WHERE alias='Azure Autogen Teachability' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias='Azure Autogen Agent Group Chat' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias='Azure Autogen R A G Qna' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias='Lookout_anomalydetection_historicaldata' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias='Forecast- Deepar Predict' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias='Forecasting-deepar Training' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias='Anomaly Detection- Aws Rcf' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias='Codegeneration_langchainplugin' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias='Codegeneration_chatbot' AND organization='leo1311';
             
             DELETE FROM mldataset WHERE alias='Vehicle Damage' AND organization='leo1311';
             DELETE FROM mldataset WHERE alias='Folderview' AND organization='leo1311';
             DELETE FROM mldataset WHERE alias='Rag_folder_view' AND organization='leo1311';
             DELETE FROM mldataset WHERE alias='Adani Enterprises Limited - Annualreport' AND organization='leo1311';
             DELETE FROM mldataset WHERE alias='Creditcard' AND organization='leo1311';
             
             DELETE FROM mlschemaregistry WHERE name='iamp' AND organization='leo1311';
             DELETE FROM mlschemaregistry WHERE name='leo1311' AND organization='leo1311';
             DELETE FROM mlschemaregistry WHERE name='NERExtraction' AND organization='leo1311';
             DELETE FROM mlschemaregistry WHERE name='ACMCLSTR30039' AND organization='leo1311';
             DELETE FROM mlschemaregistry WHERE name='InvertedIndex' AND organization='leo1311';
             DELETE FROM mlschemaregistry WHERE name='Roster Tickets' AND organization='leo1311';
             DELETE FROM mlschemaregistry WHERE name='Roster Keywords' AND organization='leo1311';
             DELETE FROM mlschemaregistry WHERE name='Tech Keyword Mapping' AND organization='leo1311';
             DELETE FROM mlschemaregistry WHERE name='Tech Classified Tickets' AND organization='leo1311';

             DELETE FROM mlintstance WHERE name='Summarization-Instance' AND organization='leo1311';
             DELETE FROM mlintstance WHERE name='Confluence-Chatbot-Instance' AND organization='leo1311';
             DELETE FROM mlintstance WHERE name='SAP-Chatbot-Instance' AND organization='leo1311';
             DELETE FROM mlintstance WHERE name='HR-Chatbot-Instance' AND organization='leo1311';
             DELETE FROM mlintstance WHERE name='Bloom-Instance' AND organization='leo1311';

             DELETE FROM mlspectemplates WHERE domainname='Confluence-chatbot-spectemplate' AND organization='leo1311';
             DELETE FROM mlspectemplates WHERE domainname='SAP-chatbot-spectemplate' AND organization='leo1311';
             DELETE FROM mlspectemplates WHERE domainname='HR-chatbot-spectemplate' AND organization='leo1311';
             DELETE FROM mlspectemplates WHERE domainname='Summarization' AND organization='leo1311';

             DELETE FROM mladapters WHERE name='Summarization-Adapter' AND organization='leo1311';
             DELETE FROM mladapters WHERE name='Confluence-Chatbot-Adapter' AND organization='leo1311';
             DELETE FROM mladapters WHERE name='SAP-Chatbot-Adapter' AND organization='leo1311';
             DELETE FROM mladapters WHERE name='HR-Chatbot-Adapter' AND organization='leo1311';
             DELETE FROM mladapters WHERE name='AICloud-Bloom' AND organization='leo1311';

             DELETE FROM mlpipeline WHERE alias = 'Ticket Summarization Chain' AND interfacetype='chain' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias = 'Semantic-Search-Demo' AND interfacetype='chain' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias = 'NLtoSQL for Chatbot' AND interfacetype='chain' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias = 'Itsm Assistant App' AND interfacetype='chain' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias = 'Semantic Search Endpoints' AND interfacetype='chain' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias = 'gen_semantic_search' AND interfacetype='chain' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias = 'Ticket Summarization Chain' AND interfacetype='chain' AND organization='leo1311';
             DELETE FROM mlpipeline WHERE alias = 'Generic Semantic Search' AND interfacetype='chain' AND organization='leo1311';
             
             DELETE FROM mlpipeline WHERE TYPE='Langchain' AND interfacetype='chain' AND organization='leo1311';

             DELETE FROM mlpipeline WHERE name IN ('LEOSNWTS90860', 'LEOSMPLP46334', 'LEOTST_P11350', 'LEOTST1211506', 'LEOTST_P77628', 'LEOTST2936928', 'LEONW_TS62346','LEOSMNTC27817','LEOSMNTC24763') AND organization='leo1311';
             DELETE FROM mlpipelinenativescriptentity WHERE cname IN ('LEOTST_P77628' ,'LEOTST_P11350', 'LEOSNWTS90860', 'LEOTST2936928', 'LEONW_TS62346') AND organization='leo1311';
             

             DELETE FROM mldatasource WHERE alias='Vm-27' and type='REMOTE' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Vm-26' and type='REMOTE' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Vm-37' and type='REMOTE' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Appexecuter' and type='REMOTE' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Vm-57' and type='REMOTE' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Victlpth5-02' and type='REMOTE' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Chatbotdemo' and type='REMOTE' AND organization='leo1311';  
             DELETE FROM mldatasource WHERE alias='Summarization' and type='REST' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Confluence-chatbot-connection' and type='REST' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Sap-chatbot-connection' and type='REST' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Chatbotapi' and type='REST' AND organization='leo1311';
             DELETE FROM mldatasource WHERE alias='Hr-chatbot-connection' and type='REST' AND organization='leo1311';

             DELETE FROM mlplugin WHERE name='Azureplugin' AND org='leo1311';
             DELETE FROM mlplugin WHERE name='Vertexplugin' AND org='leo1311';
             DELETE FROM mlplugin WHERE name='Icmmplugin' AND org='leo1311';
             DELETE FROM mlplugin WHERE name='Mlflowplugin' AND org='leo1311';
             DELETE FROM mlplugin WHERE name='Langchain' AND org='leo1311';
             
             DELETE FROM mlplugindetails WHERE pluginname IN ('SemanticSearchCore-6','SemanticSearchCore-3','SemanticSearchCore-9') AND org='leo1311';
              
		</sql>
	</changeSet>
	<changeSet author="Leap"  id="3v00To3v10-cipChatbot-acme-003">
		<sql splitStatements="true" stripComments="true">
			DELETE FROM mlplugindetails WHERE type = 'Chatbot' AND org='leo1311';
			DELETE FROM mlmashups WHERE name IN ('ITSM Assistant','APP Assistant') AND organization='leo1311';
		</sql>
	</changeSet>
	<changeSet author="Leap (generated)" id="3v00To3v10-cip-005">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mlmashups.csv" quotchar="&quot;" separator="," tableName="mlmashups">
            <column header="id" name="id" type="NUMERIC" />
			<column header="name" name="name" type="STRING" />
			<column header="template" name="template" type="STRING" />
			<column header="organization" name="organization"
				type="STRING" />
			<column header="interfacetype" name="interfacetype" type="STRING"/>

		</loadData>
    </changeSet>

	<changeSet author="Leap (generated)" id="3v00To3v10-cip-006">
    	<loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mlspectemplates.csv" quotchar="&quot;" separator="," tableName="mlspectemplates">
		   	<column header="domainname" name="domainname" type="STRING"/>
		    <column header="organization" name="organization" type="STRING"/>
		    <column header="capability" name="capability" type="STRING"/>
		    <column header="description" name="description" type="STRING"/>
		    <column header="apispectemplate" name="apispectemplate" type="STRING"/>
		    <column header="createdby" name="createdby" type="STRING"/>
		    <column header="createdon" name="createdon" type="DATE"/>
		    <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
		    <column header="lastmodifiedon" name="lastmodifiedon" type="DATE"/>
		</loadData>
	</changeSet>
	
	    <changeSet author="Leap (generated)" id="3v00To3v10-cip-007">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mladapters.csv" quotchar="&quot;" separator="," tableName="mladapters">
			<column header="name" name="name" type="STRING" />
			<column header="organization" name="organization" type="STRING" />
			<column header="connectionid" name="connectionid" type="STRING" />
			<column header="connectionname" name="connectionname" type="STRING" />
			<column header="spectemplatedomainname" name="spectemplatedomainname" type="STRING" />
			<column header="description" name="description" type="STRING" />
			<column header="category" name="category" type="STRING" />
			<column header="createdby" name="createdby" type="STRING" />
			<column header="createdon" name="createdon" type="TIMESTAMP" />
			<column header="lastmodifiedby" name="lastmodifiedby" type="STRING" />
			<column header="lastmodifiedon" name="lastmodifiedon" type="TIMESTAMP" />
			<column header="apispec" name="apispec" type="STRING" />
			<column header="isactive" name="isactive" type="STRING" />
			<column header="executiontype" name="executiontype" type="STRING" />
			<column header="isChain" name="isChain" type="BOOLEAN" />
			<column header="chainName" name="chainName" type="STRING" />
		</loadData>
    </changeSet>
    <changeSet author="Leap (generated)" id="3v00To3v10-cip-008-4-1">
        <preConditions onFail="MARK_RAN">
        <not>	
				<columnExists tableName="mlintstance" columnName="orderpriority" />
        </not>
		</preConditions>
		<sql dbms="postgres" splitStatements="true" stripComments="true">
	     	ALTER TABLE core.mlintstance ADD COLUMN IF NOT EXISTS orderpriority INTEGER;
    	</sql>
    </changeSet>
    <changeSet author="Leap (generated)" id="3v00To3v10-cip-008-4-2">
        <preConditions onFail="MARK_RAN">
            <not>	
                <columnExists tableName="mlintstance" columnName="orderpriority" />
            </not>
		</preConditions>
    	<sql dbms="mysql" splitStatements="true" stripComments="true">
      		ALTER TABLE mlintstance ADD COLUMN orderpriority INT;
      	</sql>
    </changeSet>
     <changeSet author="Leap (generated)" id="3v00To3v10-cip-008-4-3">
        <preConditions onFail="MARK_RAN">
        <not>	
				<columnExists tableName="mlintstance" columnName="orderpriority" />
        </not>
		</preConditions>
      	<sql dbms="mssql" splitStatements="true" stripComments="true">
      		ALTER TABLE mlintstance ADD orderpriority INT;
      	</sql>
    </changeSet>
    <changeSet author="Leap (generated)" id="3v00To3v10-cip-008">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mlintstance.csv" quotchar="&quot;" separator="," tableName="mlintstance">
			<column header="name" name="name" type="STRING" />
			<column header="adaptername" name="adaptername" type="STRING" />
			<column header="organization" name="organization" type="STRING" />
			<column header="connectionid" name="connectionid" type="STRING" />
			<column header="connectionname" name="connectionname" type="STRING" />
			<column header="spectemplatedomainname" name="spectemplatedomainname" type="STRING" />
			<column header="description" name="description" type="STRING" />
			<column header="category" name="category" type="STRING" />
			<column header="createdby" name="createdby" type="STRING" />
			<column header="createdon" name="createdon" type="TIMESTAMP" />
			<column header="lastmodifiedby" name="lastmodifiedby" type="STRING" />
			<column header="lastmodifiedon" name="lastmodifiedon" type="TIMESTAMP" />
			<column header="executiontype" name="executiontype" type="STRING" />
			<column header="jobid" name="jobid" type="STRING" />
			<column header="status" name="status" type="STRING" />
			<column header="runtimename" name="runtimename" type="STRING" />
			<column header="orderpriority" name="orderpriority" type="NUMERIC" />
		</loadData>
    </changeSet>

	<changeSet dbms="mysql,postgresql,mssql" author="Leap (generated)" id="3v0-cip-011">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mlpipeline.csv" quotchar="&quot;" separator="," tableName="mlpipeline">
            <column header="cid" name="cid" type="NUMERIC"/>
            <column header="created_by" name="created_by" type="STRING"/>
            <column header="created_date" name="created_date" type="datetime(6)"/>
            <column header="deleted" name="deleted" type="BOOLEAN"/>
            <column header="description" name="description" type="STRING"/>
            <column header="job_id" name="job_id" type="skip"/>
            <column header="json_content" name="json_content" type="STRING"/>
            <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="alias" name="alias" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="datetime"/>
            <column header="name" name="name" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="type" name="type" type="STRING"/>
            <column header="version" name="version" type="skip"/>
            <column header="tags" name="tags" type="STRING"/>
	    	<column header="interfacetype" name="interfacetype" type="STRING"/>
	    	<column header="pipeline_metadata" name="pipeline_metadata" type="STRING"/>
			<column header="is_template" name="is_template" type="boolean"/>
			<column header="is_app" name="is_app" type="NUMERIC"/>
        </loadData>
    </changeSet>

	<changeSet dbms="mysql,postgresql,mssql" author="Leap (generated)" id="3v0-cip-012">
	 sql dbms="mssql">
            SET IDENTITY_INSERT mlpipelinenativescriptentity ON;
         </sql>
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mlpipelinenativescriptentity.csv" quotchar="&quot;" separator="," tableName="mlpipelinenativescriptentity">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="cname" name="cname" type="STRING"/>
            <column header="filename" name="filename" type="STRING"/>
            <column header="filescript" name="filescript" type="BLOB"/>
            <column header="organization" name="organization" type="STRING"/>
        </loadData>
	 <sql dbms="mssql">
            SET IDENTITY_INSERT mlpipelinenativescriptentity OFF;
         </sql>
     </changeSet>

	 <changeSet author="Leap (generated)" id="3v00To3v10-cip-013">
		<loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mleventjobmapping.csv" quotchar="&quot;" separator="," tableName="mleventjobmapping">
			<column header="id" name="id" type="NUMERIC" />
			<column header="body" name="body" type="STRING" />
			<column header="description" name="description" type="STRING" />
			<column header="eventname" name="eventname" type="STRING" />
			<column header="jobdetails" name="jobdetails" type="STRING" />
			<column header="organization" name="organization" type="STRING" />
			<column header="interfacetype" name="interfacetype" type="STRING" />
		</loadData>
	</changeSet>

	<changeSet author="Leap"  id="3v1-usm-3">
		<sql dbms="mysql,h2" splitStatements="true" stripComments="true">
		    UPDATE usm_constant SET item_value='{"label":"AI Brain","icon":"assets/icons/digital-ai-brain.svg","children":[{"label":"Connections","icon":"","url":"./aip/connections","children":[],"_id":2},{"label":"Datasets","icon":"","url":"./aip/datasets","children":[],"_id":3},{"label":"Pipelines","icon":"","url":"./aip/pipelines","children":[],"_id":7},{"label":"Models","icon":"","url":"./aip/models","children":[],"_id":9},{"label":"Endpoints","icon":"","url":"./aip/endpoints","children":[],"_id":10},{"label":"Apps","icon":"cube","url":"./aip/app-list","children":[],"_id":11},{"label":"Adapters","icon":"","url":"","children":[{"label":"Specs","altText":null,"icon":"","url":"./aip/specs","children":[],"_id":13},{"label":"Implementations","altText":null,"icon":"","url":"./aip/implementations","children":[],"_id":14},{"label":"Instances","icon":"","url":"./aip/instances","children":[],"_id":15}],"_id":12},{"label":"Data Models","icon":"","url":"./adapters/schemas","children":[{"label":"Schemas","icon":"","url":"./aip/schemas","children":[],"_id":17},{"label":"Relationships","icon":"","url":"./aip/relationship","children":[],"_id":18}],"_id":16}],"horizontal":true}' WHERE (item = 'IT Portfolio Manager Side' OR item = 'Project Manager Side' OR item = 'Project Client Side' OR item = 'IT Portfolio Client Side') AND JSON_VALUE(item_value, '$.label')= 'AI Brain' AND project_name = 'leo1311';
		</sql>
	</changeSet>

	<changeSet author="Leap (generated)" id="3v00To3v10-cip-014">
		<loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mlsearchtopics.csv" quotchar="&quot;" separator="," tableName="mlsearchtopics">
			<column header="id" name="id" type="NUMERIC" />
			<column header="topicname" name="topicname" type="STRING" />
			<column header="organization" name="organization" type="STRING" />
			<column header="adapterinstance" name="adapterinstance" type="STRING" />
			<column header="suggested_queries" name="suggested_queries" type="STRING" />
		</loadData>
	</changeSet>
	<changeSet author="Leap (generated)" id="3v00To3v10-cip-acme-015">
        <sql>            
           INSERT INTO mleventjobmapping(body, description, eventname, organization, jobdetails, interfacetype) VALUES ('{}','generateScript_SemanticKernel', 'generateScript_SemanticKernel', 'leo1311', '[{"name":"LEACDGNR30505","type":"pipeline","runtime":{"dsAlias":"","dsName":"","type":"Local"}}]', NULL);
        
        </sql>
    </changeSet>

	 <changeSet author="leap" id="1725274085018-2">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/grhmldataset.csv" quotchar="&quot;" separator="," tableName="mldataset">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="attributes" name="attributes" type="STRING"/>
            <column header="dataset_type" name="dataset_type" type="skip"/>
            <column header="description" name="description" type="STRING"/>
            <column header="exp_status" name="exp_status" type="NUMERIC"/>
            <column header="name" name="name" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="schemajson" name="schemajson" type="STRING"/>
            <column header="type" name="type" type="STRING"/>
            <column header="backing_dataset" name="backing_dataset" type="skip"/>
            <column header="dataset_schema" name="dataset_schema" type="STRING"/>
            <column header="datasource" name="datasource" type="STRING"/>
            <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="DATE"/>
            <column header="alias" name="alias" type="STRING"/>
            <column header="context" name="context" type="skip"/>
            <column header="is_approval_required" name="is_approval_required" type="BOOLEAN"/>
            <column header="is_permission_managed" name="is_permission_managed" type="BOOLEAN"/>
            <column header="is_inbox_required" name="is_inbox_required" type="BOOLEAN"/>
            <column header="is_audit_required" name="is_audit_required" type="BOOLEAN"/>
            <column header="is_archival_enabled" name="is_archival_enabled" type="BOOLEAN"/>
            <column header="archival_config" name="archival_config" type="skip"/>
            <column header="dashboard" name="dashboard" type="skip"/>
            <column header="metadata" name="metadata" type="skip"/>
            <column header="modeltype" name="modeltype" type="skip"/>
            <column header="views" name="views" type="skip"/>
        </loadData>
    </changeSet>

	 <changeSet author="Leap (generated)" id="3v00To3v10-cip-009-acme-1">
        <loadUpdateData primaryKey="name,organization" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mldatasource.csv" quotchar="&quot;" separator="," tableName="mldatasource">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="connectiondetails" name="connectiondetails" type="STRING"/>
            <column header="description" name="description" type="STRING"/>
            <column header="dshashcode" name="dshashcode" type="STRING"/>
            <column header="name" name="name" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="salt" name="salt" type="STRING"/>
            <column header="type" name="type" type="STRING"/>
            <column header="category" name="category" type="STRING"/>
            <column header="activetime" name="activetime" type="skip"/>
            <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="DATE"/>
            <column header="alias" name="alias" type="STRING"/>
	    	<column header="extras" name="extras" type="STRING"/>
	    	<column header="interfacetype" name="interfacetype" type="STRING"/>
	    	<column header="fordataset" name="fordataset" type="NUMERIC"/>
	    	<column header="foradapter" name="foradapter" type="NUMERIC"/>
	    	<column header="forruntime" name="forruntime" type="NUMERIC"/>
	    	<column header="formodel" name="formodel" type="NUMERIC"/>
	    	<column header="forpromptprovider" name="forpromptprovider" type="NUMERIC"/>
        </loadUpdateData>
    </changeSet>
    
	 <changeSet author="Leap (generated)" id="3v00To3v10-cip-010-acme">
	<sql dbms="mssql">
            SET IDENTITY_INSERT mldataset ON;
        </sql> 
        <loadUpdateData primaryKey="name,organization" encoding="UTF-8" file="db/changelog/300_to_310/acme/cip/mldataset_cip.csv" quotchar="&quot;" separator="," tableName="mldataset">
            <column header="id" name="id" type="NUMERIC"/>
            <column header="attributes" name="attributes" type="STRING"/>
            <column header="dataset_type" name="dataset_type" type="STRING" />
            <column header="description" name="description" type="STRING"/>
            <column header="exp_status" name="exp_status" type="NUMERIC"/>
            <column header="name" name="name" type="STRING"/>
            <column header="organization" name="organization" type="STRING"/>
            <column header="schemajson" name="schemajson" type="STRING"/>
            <column header="type" name="type" type="STRING"/>
            <column header="backing_dataset" name="backing_dataset" type="STRING"/>
            <column header="dataset_schema" name="dataset_schema" type="STRING"/>
            <column header="datasource" name="datasource" type="STRING"/>
            <column header="lastmodifiedby" name="lastmodifiedby" type="STRING"/>
            <column header="lastmodifieddate" name="lastmodifieddate" type="DATE"/>
            <column header="alias" name="alias" type="STRING"/>
            <column header="context" name="context" type="STRING" />
            <column name="is_approval_required" defaultValueBoolean="false" type="boolean" />
			<column name="is_permission_managed" defaultValueBoolean="false" type="boolean" />
            <column name="is_inbox_required" defaultValueBoolean="false" type="boolean" />
	    	<column name="is_audit_required" defaultValueBoolean="false" type="boolean" />
	    	<column name="is_archival_enabled" defaultValueBoolean="false" type="boolean" />
	    	<column header="archival_config" name="archival_config" type="STRING" />
		    <column header="dashboard" name="dashboard" type="NUMERIC" />
		    <column header="metadata" name="metadata" type="STRING" />
		    <column header="modeltype" name="modeltype" type="STRING" />
		    <column header="views" name="views" type="STRING" />
		    <column header="taskdetails" name="taskdetails" type="STRING" />
		    <column header="tags" name="tags" type="STRING" />
		    <column header="interfacetype" name="interfacetype" type="STRING"/>
        </loadUpdateData>
	 <sql dbms="mssql">
            SET IDENTITY_INSERT mldataset OFF;
        </sql> 
    </changeSet>
    -->
</databaseChangeLog>
