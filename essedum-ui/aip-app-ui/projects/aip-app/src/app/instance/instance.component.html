<div *ngIf="cardToggled; else detailView" class="aip-container lfx-u-pad-lr-30" id="mainCtr">

    <!-- Header Section -->
    <app-aip-header [cardTitle]="CARD_TITLE" [lastRefreshedTime]="lastRefreshedTime" [showAddButton]="createAuth"
        (search)="onSearch($event)" (refresh)="onRefresh()" (add)="onAdd()">
    </app-aip-header>

    <!-- Filter Section -->
    <app-aip-filter [tagrefresh]="tagrefresh" [servicev1]="SERVICE_V1" [selectedAdpImplCombinedLists]="{ 
                    selectedInstanceConnectionList: selectedConnectionNamesList,
                    selectedInstanceImplementationList: selectedAdapterList
                  }" (tagSelected)="onTagSelected($event)"
        (filterStatusChange)="onFilterStatusChange($event)"></app-aip-filter>

    <!-- Loading State -->
    <div *ngIf="loading" role="status" aria-label="Loading cards">
        <app-aip-loading></app-aip-loading>
    </div>

    <!-- Content Area (only shown when not loading) -->
    <ng-container *ngIf="!loading">

        <!-- Cards container -->
        <div *ngIf="paginatedCards.length > 0" class="aip-card-container lfx-u-pad-b-85" id="containerDivForScroll"
            aria-label="Adapter cards">
            <div class="aip-card-wrapper" *ngFor="let card of paginatedCards; trackBy: trackByCardId">

                <app-aip-card [servicev1]="SERVICE_V1" [card]="card" [editAuth]="editAuth" [deployAuth]="deployAuth"
                    [deleteAuth]="deleteAuth" (viewDetails)="onViewDetails(card)" (edit)="openedit(editModal)"
                    (delete)="deleteInstance(card.name)">
                </app-aip-card>

                <!-- Edit Modal Template -->
                <ng-template #editModal let-modal>
                    <app-instance-create-edit [data]=card [action]="EDIT_ACTION"
                        (triggereRefresh)="triggereRefresh($event)"></app-instance-create-edit>
                </ng-template>

            </div>
        </div>

        <!-- Empty state -->
        <app-aip-empty-state *ngIf="shouldShowEmptyState"></app-aip-empty-state>

        <!-- Pagination -->
        <app-aip-pagination *ngIf="shouldShowPagination" [pageNumber]="pageNumber" [noOfPages]="noOfPages"
            [pageArr]="pageArr" [startIndex]="startIndex" [endIndex]="endIndex" [hoverStates]="hoverStates"
            (prevPage)="onPrevPage()" (nextPage)="onNextPage()" (changePage)="onChangePage($event)">
        </app-aip-pagination>

    </ng-container>
</div>

<!-- Detail view template -->
<ng-template #detailView>
    <app-instance-description [card]="selectedCard" (newItemEvent)="changedToogle($event)"
        [cardToggled]="cardToggled"></app-instance-description>
</ng-template>